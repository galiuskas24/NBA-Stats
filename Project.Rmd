---
title: "NBA-Players-Statistic"
author: "Disperzanti"
date: "May 12, 2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(gridExtra)
players.bySeasons = read.csv("nba-players-stats/Seasons_Stats.csv")
players.bySeasons.info = read.csv("nba-players-stats/Players.csv")
```

# 1. Da li su viši centri nužno i bolji skakači?
Centar je igrač koji većinu svog vremena provodi pod košem vrebajući skokove. Zbog toga je zanimljivo proučavati da li je visina igrača ključni parametar za skupljanje skokova?

```{r, echo=FALSE}
# Load seasons stats
players.bySeasons %>% select(Year,G,Player,Pos,TRB) -> players

# Remove NA
players = players[complete.cases(players),]

#only centers
centers = players[grep("C", players$Pos),]

# Calculate Rebound Per Game
centers %>% group_by(Player)  %>% summarize(RPG = sum(TRB)/sum(G)) -> centers

# Load personal information of players
players.bySeasons.info %>% select(Player, height, weight)-> players.info

# Inner join
centers = merge(centers, players.info)

# Seperate higher and lower centers by mean
centers.height.mean = mean(centers$height)
centers[centers$height >= centers.height.mean,] -> higher.centers
centers[centers$height < centers.height.mean,] -> lower.centers
```

Razdioba visina i skokova svih centara:
```{r}
summary(centers)
hist(centers$RPG)
hist(centers$height)
#plot(centers$height, centers$RPG, type="p")
```

Razdioba nižih i viših centara:
```{r}
summary(higher.centers)
summary(lower.centers)
hist(higher.centers$RPG)
hist(lower.centers$RPG)
hist(lower.centers$height)
hist(higher.centers$height)
```


# 2. Da li je bolje evoluirao napad ili odbrana NBA igrača?
Za očekivati je da svaka igra/sport, pa tako i košarka, evoluira. Ako je napad igrača puno bolji od odbrane onda će se prosječno postizati puno više koševa po utakmici, u protivnom će biti jako malo koševa. Naš zadatak je istražiti da li se tijekom povijesti jedan od ta dva dijela igra značajno promijenio.
```{r, echo=FALSE}
read.csv("nba-players-stats/Seasons_info_full.csv") -> seasons
read.csv("nba-players-stats/Seasons_info.csv") -> seasons.teams.games

# Inner join
seasons = merge(seasons, seasons.teams.games)

# Cut data
#seasons.info[seasons.info$Season > 1990,] -> seasons.info
```

Broj koševa po NBA sezoni:
```{r}
#plot(seasons$Year, seasons$Games, type="p")
#plot(seasons$Year, seasons$Teams)
plot(seasons$Year, seasons$PTS)

```


# 3. Tko je bolji šuter za tri poena, SG ili C?
```{r, echo=FALSE}
# Load seasons stats
players.bySeasons %>% select(Player,Pos,X3P,X3PA) -> players

# Remove NA
players = players[complete.cases(players),]

# divide dataset
centers = players[grep("C", players$Pos),]
s.guards = players[grep("SG", players$Pos),]

# Remove players wiht 0 3PA per season
centers = centers[centers$X3PA > 0,]
s.guards = s.guards[s.guards$X3PA > 0,]

# Calculate 3P%
centers %>% group_by(Player)  %>% summarize(X3PPG = sum(X3P)/sum(X3PA), X3PA = sum(X3PA)) -> centers
s.guards  %>% group_by(Player)  %>% summarize(X3PPG = sum(X3P)/sum(X3PA), X3PA = sum(X3PA)) -> s.guards

#TODO: tu mozemo pobrisati igrace koji su imali premalo pokusaja recimo < 20 tijekom cijele karijere
# ili mozemo pobrisati igrace s postotkom suta vecimo do 60% jer ih je jako malo itd.
```

Broj pokušaja šuta za 3 poena centara i bek šuter:
```{r}
hist(centers$X3PA)
hist(s.guards$X3PA)
```

Postotak pogođenih trica centara i bek šutera:
```{r}
summary(centers)
summary(s.guards)
hist(centers$X3PPG)
hist(s.guards$X3PPG)
```



# 4. Da li su igrači bolji u prvoj polovici karijere ili u drugoj?
Igrači su najbolji u sredini svoje karijere jer na početku nisu previše iskusni a na kraju su većinom prestari i fizički iscrpljeni zbog čega igraju lošije.
```{r}
read.csv("nba-players-stats/Kobe_Bryant.csv") -> kobe
plot(kobe$Season, kobe$PTS)
hist(kobe$PTS)
```


# 5. Da li širina raspona ruku utječe na efikasnost ukradenih lopti?
```{r}
```


# 6. hall-of-fame vs basic-players
```{r}
```


# 7. Da li su bolji igrači podrijetlom iz USA ili ostatka svijeta?
```{r}
```

# 8. Da li se pozicije Hall-of-Fame igrača ravnomjerno raspodijeljene? 
chi^2 normal hall-of-fame
```{r, echo=FALSE}
# Load seasons stats
players.bySeasons %>% select(Player,Pos) -> players

# Remove NA
players = players[complete.cases(players),]

# only HOF players
players = players[grep("\\*", players$Player),]

players[grep("PG", players$Pos),] %>% distinct(Player) -> players.pg 
players[grep("SG", players$Pos),] %>% distinct(Player) -> players.sg 
players[grep("SF", players$Pos),] %>% distinct(Player) -> players.sf 
players[grep("PF", players$Pos),] %>% distinct(Player) -> players.pf 
players[grep("C", players$Pos),] %>% distinct(Player) -> players.c 

vector = c(length(players.pg$Player),
           length(players.sg$Player),
           length(players.sf$Player),
           length(players.pf$Player),
           length(players.c$Player))

uniform = c(1,1,1,1,1)*sum(vector)*0.2
sample = rbind(vector, uniform)

sample
chisq.test(sample)
```

Prikaz HOF igrača po pozicijama:
```{r}
barplot(vector, names.arg=c("PG", "SG", "SF", "PF","C"))
```